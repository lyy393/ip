<!doctype html>
<html lang="ms">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lacak IP ‚Äî NeoRed</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="" crossorigin=""/>

  <style>
    :root{
      --bg:#0f0b10;
      --panel:#221521;
      --accent1:#ff2f6d;
      --accent2:#ff5f90;
      --glow: 0 8px 30px rgba(255,47,109,0.18);
      --muted:#9b86a6;
      --card:#2a1f27;
      --radius:14px;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#0b0710 0%, #150a12 100%);color:#fff;}
    .wrap{max-width:480px;margin:28px auto;padding:22px;border-radius:18px;background:linear-gradient(180deg, rgba(255,47,109,0.04), rgba(0,0,0,0.03)); box-shadow: inset 0 1px 0 rgba(255,255,255,0.02); border:1px solid rgba(255,47,109,0.06);}
    h1{font-size:28px;text-align:center;margin:6px 0 8px;color:var(--accent1);text-shadow:0 1px 0 rgba(255,255,255,0.02);letter-spacing:2px;}
    p.lead{color:var(--muted);text-align:center;font-size:13px;margin-top:0;margin-bottom:18px;}
    .input-row{display:flex;gap:12px;align-items:center;margin-bottom:18px;}
    input[type="text"]{
      flex:1;padding:14px 16px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);background:rgba(20,12,16,0.6);color:#fff;font-size:15px;outline:none;box-shadow: none;
    }
    button.btn{
      padding:14px 18px;border-radius:12px;border:none;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#111;font-weight:600;font-size:15px;cursor:pointer;box-shadow:var(--glow);
      display:flex;align-items:center;gap:8px;
    }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.06));
      border-radius:14px;padding:14px;border:1px solid rgba(255,47,109,0.06);
      margin-bottom:14px;
    }
    .card h3{margin:6px 0 10px;color:var(--accent2);font-size:16px;}
    .info-row{display:flex;gap:10px;align-items:center;margin:8px 0;color:var(--muted);}
    .info-row strong{width:110px;color:#ffd6e2;}
    .flag-img{width:28px;height:18px;border-radius:3px;object-fit:cover;margin-right:8px;box-shadow:0 2px 8px rgba(0,0,0,0.4);}
    #map{height:300px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);overflow:hidden}
    .muted{color:var(--muted);font-size:13px;}
    .error{color:#ffb3c4;background:rgba(255,47,109,0.06);padding:8px;border-radius:10px;margin-top:8px;border:1px solid rgba(255,47,109,0.06);}
    footer.bottomnav{display:flex;gap:18px;justify-content:space-around;padding:14px 6px;margin-top:16px;border-radius:12px;background:linear-gradient(180deg,rgba(0,0,0,0.03),rgba(0,0,0,0.06));}
    .nav-item{font-size:13px;color:var(--muted);}
    /* small responsive */
    @media (max-width:520px){.wrap{margin:12px;padding:16px}}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>LACAK IP BY LYY</h1>
    <p class="lead">Track location information by IP address</p>

    <div class="input-row">
      <input id="ipInput" type="text" placeholder="Masukkan IP (contoh: 36.73.34.90)" value="">
      <button id="trackBtn" class="btn">üîç Track IP</button>
    </div>

    <div id="resultCard" class="card" style="display:none;">
      <h3>Maklumat IP</h3>
      <div class="info-row"><strong>IP:</strong><div id="ipVal" class="muted"></div></div>
      <div class="info-row"><strong>Negara:</strong><div id="countryVal" class="muted"></div></div>
      <div class="info-row"><strong>Bendera:</strong><img id="flagImg" class="flag-img" src="" alt="" style="display:none;"><div id="flagUrl" class="muted" style="word-break:break-all"></div></div>
      <div class="info-row"><strong>Wilayah:</strong><div id="regionVal" class="muted"></div></div>
      <div class="info-row"><strong>Kota:</strong><div id="cityVal" class="muted"></div></div>
      <div class="info-row"><strong>ISP:</strong><div id="ispVal" class="muted"></div></div>
      <div class="info-row"><strong>Koordinat:</strong><div id="coordVal" class="muted"></div></div>
      <div id="errorBox" style="display:none;" class="error"></div>
    </div>

    <div id="mapCard" class="card" style="display:none;">
      <div id="map"></div>
    </div>

    <footer class="bottomnav">
      <div class="nav-item">Home</div>
      <div class="nav-item">Users</div>
      <div class="nav-item" style="color:var(--accent2)">IP Track</div>
      <div class="nav-item">Chat</div>
      <div class="nav-item">Logout</div>
    </footer>
  </div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="" crossorigin=""></script>

  <script>
    // Helper: validate basic IPv4 or IPv6 (simple)
    function isValidIP(ip){
      if(!ip) return false;
      ip = ip.trim();
      // IPv4 basic check
      const v4 = /^(\d{1,3}\.){3}\d{1,3}$/;
      const v6 = /:/;
      if(v4.test(ip)){
        return ip.split('.').every(n => Number(n) >=0 && Number(n) <=255);
      } else if (v6.test(ip)){
        // basic presence of colon for IPv6; accept for now
        return true;
      }
      return false;
    }

    const trackBtn = document.getElementById('trackBtn');
    const ipInput = document.getElementById('ipInput');
    const resultCard = document.getElementById('resultCard');
    const mapCard = document.getElementById('mapCard');
    const errorBox = document.getElementById('errorBox');

    let map = null;
    let marker = null;

    function showError(msg){
      errorBox.style.display = 'block';
      errorBox.textContent = msg;
    }
    function clearError(){
      errorBox.style.display = 'none';
      errorBox.textContent = '';
    }

    async function trackIP(ip){
      clearError();
      // API: ipwhois.app (public, no-key) - endpoint: https://ipwhois.app/json/{ip}
      const url = 'https://ipwhois.app/json/' + encodeURIComponent(ip);
      try{
        const res = await fetch(url);
        if(!res.ok) throw new Error('Ralat pada permintaan: ' + res.status);
        const data = await res.json();

        if(data.success === false || data.ip === undefined){
          // Some APIs return success=false and message
          const msg = data.message || 'Tiada maklumat ditemui untuk IP ini.';
          showError(msg);
          resultCard.style.display = 'none';
          mapCard.style.display = 'none';
          return;
        }

        // Fill info
        document.getElementById('ipVal').textContent = data.ip || ip;
        document.getElementById('countryVal').textContent = (data.country || '') + (data.country_code ? ' ('+data.country_code+')' : '');
        // flag: ipwhois sometimes returns "country_flag" or a flag url. If not, construct flag via country_code (cdn.ipwhois.io/flags/{cc}.svg as in screenshot)
        const flagImgEl = document.getElementById('flagImg');
        const flagUrlEl = document.getElementById('flagUrl');
        let flagUrl = data.country_flag || (data.country_code ? 'https://cdn.ipwhois.io/flags/' + data.country_code.toLowerCase() + '.svg' : '');
        if(flagUrl){
          flagImgEl.src = flagUrl;
          flagImgEl.style.display = 'inline-block';
          flagUrlEl.textContent = flagUrl;
        } else {
          flagImgEl.style.display = 'none';
          flagUrlEl.textContent = '-';
        }

        document.getElementById('regionVal').textContent = data.region || data.region_name || '-';
        document.getElementById('cityVal').textContent = data.city || '-';
        document.getElementById('ispVal').textContent = data.isp || data.org || '-';
        const lat = parseFloat(data.latitude || data.lat || data.latitude);
        const lon = parseFloat(data.longitude || data.lon || data.longitude);
        if(!isNaN(lat) && !isNaN(lon)){
          document.getElementById('coordVal').textContent = lat.toFixed(6) + ', ' + lon.toFixed(6);
        } else {
          document.getElementById('coordVal').textContent = '-';
        }

        resultCard.style.display = 'block';

        // Map: initialize or set view
        if(!isNaN(lat) && !isNaN(lon)){
          mapCard.style.display = 'block';
          if(!map){
            map = L.map('map', {zoomControl:true, attributionControl: true}).setView([lat, lon], 8);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
              maxZoom: 19,
              attribution: '&copy; OpenStreetMap contributors'
            }).addTo(map);
            marker = L.marker([lat, lon]).addTo(map);
            marker.bindPopup('Lokasi IP ' + (data.ip || ip) + '<br>' + ((data.city || '') + (data.region ? ', ' + data.region : '') + (data.country ? ', ' + data.country : '') ) ).openPopup();
          } else {
            map.setView([lat, lon], 8);
            marker.setLatLng([lat, lon]);
            marker.getPopup().setContent('Lokasi IP ' + (data.ip || ip) + '<br>' + ((data.city || '') + (data.region ? ', ' + data.region : '') + (data.country ? ', ' + data.country : '') ) );
            marker.openPopup();
          }
        } else {
          mapCard.style.display = 'none';
          showError('Koordinat tidak tersedia untuk IP ini.');
        }

      }catch(err){
        showError('Ralat: ' + err.message);
        resultCard.style.display = 'none';
        mapCard.style.display = 'none';
      }
    }

    // handle button click
    trackBtn.addEventListener('click', ()=>{
      const ip = ipInput.value.trim();
      if(!ip){
        showError('Sila masukkan alamat IP.');
        return;
      }
      if(!isValidIP(ip)){
        // not strict IPv6 validation but warn
        const proceed = confirm('IP nampak tidak standard. Teruskan cuba? (Tekan OK untuk terus, Cancel untuk betulkan)');
        if(!proceed) return;
      }
      trackIP(ip);
    });

    // allow Enter key
    ipInput.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter') trackBtn.click();
    });

    // OPTIONAL: prefill with example IP from screenshot
    ipInput.value = '36.73.34.90';
  </script>
</body>
</html>